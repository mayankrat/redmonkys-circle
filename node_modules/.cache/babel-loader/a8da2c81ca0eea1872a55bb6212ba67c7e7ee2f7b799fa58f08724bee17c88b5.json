{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import{initializeApp}from'firebase/app';import{getAuth,onAuthStateChanged,signOut as firebaseSignOut,signInWithCustomToken,signInAnonymously}from'firebase/auth';import{getFirestore,doc,getDoc,setDoc,collection,query,addDoc,updateDoc,deleteDoc,onSnapshot,serverTimestamp}from'firebase/firestore';// --- Firebase Configuration ---\n// This is now your real project configuration.\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const firebaseConfig={apiKey:\"AIzaSyD2Q_M1tUmEELmYZJekOJCCTYtwlM-_2DU\",authDomain:\"redmonkys-circle-ultimate.firebaseapp.com\",projectId:\"redmonkys-circle-ultimate\",storageBucket:\"redmonkys-circle-ultimate.firebasestorage.app\",messagingSenderId:\"337937977339\",appId:\"1:337937977339:web:b76ae3d7da470558b0855e\",measurementId:\"G-7P6JRHKNMK\"};// --- Initialize Firebase ---\nconst app=initializeApp(firebaseConfig);const auth=getAuth(app);const db=getFirestore(app);// --- Main App Component ---\nexport default function App(){const[page,setPage]=useState('home');const[user,setUser]=useState(null);const[userData,setUserData]=useState(null);const[loading,setLoading]=useState(true);const[currentQuestionId,setCurrentQuestionId]=useState(null);useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async currentUser=>{if(currentUser){setUser(currentUser);const userDocRef=doc(db,'users',currentUser.uid);const userDocSnap=await getDoc(userDocRef);if(userDocSnap.exists()){const data=userDocSnap.data();setUserData(data);if(!data.username)setPage('setUsername');else if(!data.onboardingComplete)setPage('onboarding');else if(page!=='question')setPage('feed');}else{setPage('setUsername');}}else{setUser(null);setUserData(null);setPage('home');}setLoading(false);});const performSignIn=async()=>{if(!auth.currentUser){try{// For the proxy, we'll rely on anonymous sign-in initially.\n// A more advanced setup could pass a customer token from Shopify.\nawait signInAnonymously(auth);}catch(error){console.error(\"Error during automatic sign-in:\",error);setLoading(false);}}};performSignIn();return()=>unsubscribe();},[]);const handleLogout=async()=>{try{await firebaseSignOut(auth);setPage('home');}catch(error){console.error(\"Error signing out:\",error);}};const navigateTo=function(pageName){let questionId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;setPage(pageName);setCurrentQuestionId(questionId);};if(loading)return/*#__PURE__*/_jsx(LoadingScreen,{});const renderPage=()=>{switch(page){case'home':return/*#__PURE__*/_jsx(WelcomePage,{});case'setUsername':return/*#__PURE__*/_jsx(SetUsernamePage,{user:user,onComplete:()=>navigateTo('onboarding')});case'onboarding':return/*#__PURE__*/_jsx(OnboardingPage,{user:user,onComplete:()=>navigateTo('feed')});case'feed':return/*#__PURE__*/_jsx(CommunityFeed,{navigateTo:navigateTo,user:user});case'question':return/*#__PURE__*/_jsx(QuestionDetailPage,{questionId:currentQuestionId,user:user,userData:userData,navigateTo:navigateTo});case'profile':return/*#__PURE__*/_jsx(ProfilePage,{user:user,userData:userData,setUserData:setUserData,onComplete:()=>navigateTo('feed')});case'ask':return/*#__PURE__*/_jsx(AskQuestionPage,{user:user,userData:userData,onComplete:id=>navigateTo('question',id)});default:return/*#__PURE__*/_jsx(WelcomePage,{});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 min-h-screen font-sans\",children:[/*#__PURE__*/_jsx(Header,{user:user,userData:userData,onLogout:handleLogout,navigateTo:navigateTo}),/*#__PURE__*/_jsx(\"main\",{className:\"container mx-auto px-4 py-8\",children:renderPage()})]});}// --- Components ---\nconst brandColor='#6d0b0b';function Header(_ref){let{user,userData,onLogout,navigateTo}=_ref;return/*#__PURE__*/_jsx(\"header\",{className:\"bg-white shadow-md sticky top-0 z-50\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"container mx-auto px-4 py-3 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold cursor-pointer\",style:{color:brandColor},onClick:()=>navigateTo(user?'feed':'home'),children:\"RedMonkys Circle\"}),user&&(userData===null||userData===void 0?void 0:userData.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('ask'),style:{backgroundColor:brandColor},className:\"text-white px-4 py-2 rounded-full hover:bg-[#5a0909] transition duration-300 font-semibold\",children:\"Ask Question\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center text-lg font-bold text-gray-600 cursor-pointer\",children:userData.username.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20 hidden group-hover:block\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"#\",onClick:e=>{e.preventDefault();navigateTo('profile');},className:\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\",children:\"Profile\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#\",onClick:e=>{e.preventDefault();onLogout();},className:\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\",children:\"Logout\"})]})]})]})]})});}function WelcomePage(){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-16 max-w-3xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl md:text-5xl font-extrabold text-gray-800 mb-6\",children:\"\\uD83E\\uDD0D Welcome to RedMonkys Circle.\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-lg text-gray-600 mb-8 leading-relaxed\",children:[\"This space is made just for you \\u2014 the loving, curious, sometimes-tired, always-caring parent. Whether you have questions, stories, doubts, or advice \\u2014 you're not alone. Ask freely. Share generously. Support each other. At RedMonkys, we believe that every parent/guardian deserves to be heard, and every child deserves a world full of love, understanding, and growth. This is a judgment-free zone \\u2014 a gentle corner of the internet where you\\u2019re seen, your concerns matter, and your voice helps others feel a little less alone.\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Together, we\\u2019re building more than a brand. We\\u2019re building a community of care.\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{},className:\"bg-white border border-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-lg shadow-sm hover:shadow-md transition-all duration-300 flex items-center mx-auto\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"w-6 h-6 mr-3\",viewBox:\"0 0 48 48\",children:[/*#__PURE__*/_jsx(\"path\",{fill:\"#4285F4\",d:\"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#34A853\",d:\"M46.98 24.55c0-1.57-.15-3.09-.42-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#FBBC05\",d:\"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"#EA4335\",d:\"M24 48c6.48 0 11.87-2.13 15.84-5.73l-7.73-6c-2.52 1.7-5.94 2.73-9.91 2.73-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\"}),/*#__PURE__*/_jsx(\"path\",{fill:\"none\",d:\"M0 0h48v48H0z\"})]}),\"Login with Google\"]})]});}function SetUsernamePage(_ref2){let{user,onComplete}=_ref2;const[username,setUsername]=useState('');const[isValid,setIsValid]=useState(false);const[isAvailable,setIsAvailable]=useState(true);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const checkUsernameAvailability=useMemo(()=>{const debounce=(func,delay)=>{let timeout;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}clearTimeout(timeout);timeout=setTimeout(()=>func(...args),delay);};};return debounce(async name=>{if(name.length>2){setLoading(true);const usernameDocRef=doc(db,'usernames',name);const docSnap=await getDoc(usernameDocRef);setIsAvailable(!docSnap.exists());setLoading(false);}},500);},[]);const handleUsernameChange=e=>{const value=e.target.value.toLowerCase();const regex=/^[a-z0-9_]+$/;setUsername(value);if(regex.test(value)&&value.length>=3&&value.length<=15){setIsValid(true);setError('');checkUsernameAvailability(value);}else{setIsValid(false);setError('3-15 chars, lowercase, numbers, or _');}};const handleSubmit=async e=>{e.preventDefault();if(!isValid||!isAvailable||loading||!user)return;setLoading(true);setError('');try{const userDocRef=doc(db,'users',user.uid);const usernameDocRef=doc(db,'usernames',username);await setDoc(userDocRef,{uid:user.uid,email:user.email||'anonymous',username:username,createdAt:serverTimestamp()},{merge:true});await setDoc(usernameDocRef,{uid:user.uid});onComplete();}catch(err){console.error(err);setError('Could not save username. Please try again.');setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md mx-auto bg-white p-8 rounded-lg shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-2\",children:\"Create your username\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:\"This is permanent and will be shown with your questions and answers.\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500\",children:\"@\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,onChange:handleUsernameChange,className:\"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-md focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\",placeholder:\"your_unique_username\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"h-5 mt-1 text-sm\",children:[loading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Checking...\"}),!loading&&username&&!isAvailable&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500\",children:\"Username already taken.\"}),!loading&&username&&isAvailable&&isValid&&/*#__PURE__*/_jsx(\"p\",{className:\"text-green-500\",children:\"Username is available!\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500\",children:error})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!isValid||!isAvailable||loading,style:{backgroundColor:brandColor},className:\"w-full mt-4 text-white py-2 px-4 rounded-md hover:bg-[#5a0909] disabled:bg-gray-400 transition\",children:\"Confirm Username\"})]})]});}function OnboardingPage(_ref3){let{user,onComplete}=_ref3;const[step,setStep]=useState(1);const[role,setRole]=useState('');const[children,setChildren]=useState([{name:'',dob:'',gender:''}]);const[dueDate,setDueDate]=useState({month:'',year:''});const[referral,setReferral]=useState('');const[loading,setLoading]=useState(false);const handleRoleSelect=selectedRole=>{setRole(selectedRole);setStep(2);};const handleAddChild=()=>{setChildren([...children,{name:'',dob:'',gender:''}]);};const handleChildChange=(index,field,value)=>{const newChildren=[...children];newChildren[index][field]=value;setChildren(newChildren);};const handleRemoveChild=index=>{const newChildren=children.filter((_,i)=>i!==index);setChildren(newChildren);};const handleSubmit=async e=>{e.preventDefault();if(!referral){alert(\"Please let us know how you heard about us.\");return;}setLoading(true);const userDocRef=doc(db,'users',user.uid);const onboardingData={role,children:role==='parent'?children.filter(c=>c.name||c.dob||c.gender):[],dueDate:role==='expecting'?dueDate:{},referral,onboardingComplete:true,updatedAt:serverTimestamp()};try{await setDoc(userDocRef,onboardingData,{merge:true});onComplete();}catch(error){console.error(\"Error saving onboarding data:\",error);setLoading(false);}};const today=new Date().toISOString().split('T')[0];const currentYear=new Date().getFullYear();const currentMonth=new Date().getMonth()+1;const months=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"];const years=Array.from({length:10},(_,i)=>currentYear+i);return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-4\",children:\"Tell us a bit about yourself\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-8\",children:\"This helps us personalize your experience.\"}),step===1&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-lg\",children:\"First, what best describes you?\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRoleSelect('parent'),className:\"w-full text-left p-4 border rounded-lg hover:bg-red-50 hover:border-[#6d0b0b] transition\",children:\"I'm a parent / guardian\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRoleSelect('expecting'),className:\"w-full text-left p-4 border rounded-lg hover:bg-red-50 hover:border-[#6d0b0b] transition\",children:\"I will be a parent soon\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRoleSelect('not_parent'),className:\"w-full text-left p-4 border rounded-lg hover:bg-red-50 hover:border-[#6d0b0b] transition\",children:\"I'm not a parent\"})]}),step===2&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[role==='parent'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-lg mb-4\",children:\"Tell us about your child/children.\"}),children.map((child,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 border p-4 rounded-lg mb-4 relative\",children:[children.length>1&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleRemoveChild(index),className:\"absolute top-2 right-2 text-red-500 hover:text-red-700\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Child's Name/Nickname\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:child.name,onChange:e=>handleChildChange(index,'name',e.target.value),className:\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Child's Date of Birth\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",max:today,value:child.dob,onChange:e=>handleChildChange(index,'dob',e.target.value),className:\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Child's Gender\"}),/*#__PURE__*/_jsxs(\"select\",{value:child.gender,onChange:e=>handleChildChange(index,'gender',e.target.value),className:\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"male\",children:\"Male\"}),/*#__PURE__*/_jsx(\"option\",{value:\"female\",children:\"Female\"}),/*#__PURE__*/_jsx(\"option\",{value:\"prefer_not_to_say\",children:\"Prefer not to say\"})]})]})]},index)),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleAddChild,className:\"font-semibold\",style:{color:brandColor},children:\"+ Add another child\"})]}),role==='expecting'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-lg mb-4\",children:\"Congratulations! When are you due?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Month\"}),/*#__PURE__*/_jsxs(\"select\",{value:dueDate.month,onChange:e=>setDueDate({...dueDate,month:e.target.value}),className:\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Month\"}),months.map((month,i)=>/*#__PURE__*/_jsx(\"option\",{value:i+1,disabled:dueDate.year==currentYear&&i+1<currentMonth,children:month},month))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Year\"}),/*#__PURE__*/_jsxs(\"select\",{value:dueDate.year,onChange:e=>setDueDate({...dueDate,year:e.target.value}),className:\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Year\"}),years.map(year=>/*#__PURE__*/_jsx(\"option\",{value:year,children:year},year))]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"referral\",className:\"block text-lg font-semibold text-gray-700\",children:\"How did you hear about us? (Required)\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"referral\",value:referral,onChange:e=>setReferral(e.target.value),required:true,className:\"mt-2 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b] p-2\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select an option...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"facebook\",children:\"Facebook\"}),/*#__PURE__*/_jsx(\"option\",{value:\"instagram\",children:\"Instagram\"}),/*#__PURE__*/_jsx(\"option\",{value:\"youtube\",children:\"YouTube\"}),/*#__PURE__*/_jsx(\"option\",{value:\"google\",children:\"Google Search\"}),/*#__PURE__*/_jsx(\"option\",{value:\"friend_family\",children:\"Referred by friend or family\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{backgroundColor:brandColor},className:\"text-white py-2 px-6 rounded-md hover:bg-[#5a0909] disabled:bg-gray-400 transition\",children:loading?'Saving...':'Finish & Enter Circle'})})]})]});}function CommunityFeed(_ref4){let{navigateTo,user}=_ref4;const[questions,setQuestions]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{if(!user){setLoading(true);return;}const q=query(collection(db,'questions'));const unsubscribe=onSnapshot(q,querySnapshot=>{const questionsData=querySnapshot.docs.map(doc=>({id:doc.id,...doc.data()}));questionsData.sort((a,b)=>{var _b$createdAt,_a$createdAt;return(((_b$createdAt=b.createdAt)===null||_b$createdAt===void 0?void 0:_b$createdAt.seconds)||0)-(((_a$createdAt=a.createdAt)===null||_a$createdAt===void 0?void 0:_a$createdAt.seconds)||0);});setQuestions(questionsData);setLoading(false);},error=>{console.error(\"Firestore permission error in CommunityFeed:\",error);setLoading(false);});return()=>unsubscribe();},[user]);if(loading)return/*#__PURE__*/_jsx(LoadingScreen,{text:\"Loading the Circle...\"});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-6\",children:\"Community Circle\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"divide-y divide-gray-200\",children:questions.map(q=>/*#__PURE__*/_jsxs(\"li\",{className:\"p-6 hover:bg-gray-50 cursor-pointer\",onClick:()=>navigateTo('question',q.id),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-lg text-gray-800 hover:text-[#6d0b0b]\",children:q.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1 line-clamp-2\",children:q.content}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-3 text-xs text-gray-500\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Asked by @\",q.authorUsername]}),/*#__PURE__*/_jsxs(\"span\",{children:[q.answerCount||0,\" answers\"]})]})]},q.id))})})]});}function QuestionDetailPage(_ref5){let{questionId,user,userData,navigateTo}=_ref5;const[question,setQuestion]=useState(null);const[answers,setAnswers]=useState([]);const[loading,setLoading]=useState(true);const[newAnswer,setNewAnswer]=useState('');useEffect(()=>{if(!user||!questionId){setLoading(true);return;}const questionRef=doc(db,'questions',questionId);const unsubscribeQuestion=onSnapshot(questionRef,docSnap=>{if(docSnap.exists())setQuestion({id:docSnap.id,...docSnap.data()});else console.error(\"Question not found\");setLoading(false);},error=>{console.error(\"Firestore permission error on question:\",error);setLoading(false);});const answersQuery=query(collection(db,`questions/${questionId}/answers`));const unsubscribeAnswers=onSnapshot(answersQuery,snapshot=>{const answersData=snapshot.docs.map(doc=>({id:doc.id,...doc.data()}));answersData.sort((a,b)=>{var _b$upvotes,_a$upvotes;return(((_b$upvotes=b.upvotes)===null||_b$upvotes===void 0?void 0:_b$upvotes.length)||0)-(((_a$upvotes=a.upvotes)===null||_a$upvotes===void 0?void 0:_a$upvotes.length)||0);});setAnswers(answersData);},error=>{console.error(\"Firestore permission error on answers:\",error);});return()=>{unsubscribeQuestion();unsubscribeAnswers();};},[questionId,user]);const handleAnswerSubmit=async e=>{e.preventDefault();if(newAnswer.trim()===''||!user)return;const answerRef=collection(db,`questions/${questionId}/answers`);await addDoc(answerRef,{content:newAnswer,authorId:user.uid,authorUsername:userData.username,createdAt:serverTimestamp(),upvotes:[]});const questionRef=doc(db,'questions',questionId);await updateDoc(questionRef,{answerCount:answers.length+1});setNewAnswer('');};const handleVote=async(answerId,currentUpvotes)=>{if(!user)return;const answerRef=doc(db,`questions/${questionId}/answers`,answerId);const userId=user.uid;let newUpvotes=[...(currentUpvotes||[])];if(newUpvotes.includes(userId))newUpvotes=newUpvotes.filter(uid=>uid!==userId);else newUpvotes.push(userId);await updateDoc(answerRef,{upvotes:newUpvotes});};if(loading)return/*#__PURE__*/_jsx(LoadingScreen,{text:\"Loading question...\"});if(!question)return/*#__PURE__*/_jsxs(\"div\",{children:[\"Question not found. \",/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('feed'),children:\"Back to feed\"})]});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-2\",children:question.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500 mb-4\",children:[\"Asked by @\",question.authorUsername]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 whitespace-pre-wrap mb-8\",children:question.content}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-8\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-4\",children:[answers.length,\" Answers\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:answers.map((answer,index)=>{var _answer$upvotes,_answer$upvotes2,_answer$upvotes3,_answer$upvotes4;return/*#__PURE__*/_jsxs(\"div\",{className:`bg-white p-6 rounded-lg shadow ${index===0&&((_answer$upvotes=answer.upvotes)===null||_answer$upvotes===void 0?void 0:_answer$upvotes.length)>0?'border-2 border-green-400':''}`,children:[index===0&&((_answer$upvotes2=answer.upvotes)===null||_answer$upvotes2===void 0?void 0:_answer$upvotes2.length)>0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-bold text-green-600 mb-2\",children:\"BEST ANSWER\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-800 mb-4\",children:answer.content}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[\"Answered by @\",answer.authorUsername]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleVote(answer.id,answer.upvotes),className:\"group\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:`h-7 w-7 transition-all duration-200 ${(_answer$upvotes3=answer.upvotes)!==null&&_answer$upvotes3!==void 0&&_answer$upvotes3.includes(user===null||user===void 0?void 0:user.uid)?'text-red-500 scale-110':'text-gray-400 group-hover:text-red-300'}`,viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z\",clipRule:\"evenodd\"})})}),/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-gray-700\",children:((_answer$upvotes4=answer.upvotes)===null||_answer$upvotes4===void 0?void 0:_answer$upvotes4.length)||0})]})]})]},answer.id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-10 bg-white p-6 rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg mb-4\",children:\"Your Answer\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAnswerSubmit,children:[/*#__PURE__*/_jsx(\"textarea\",{value:newAnswer,onChange:e=>setNewAnswer(e.target.value),className:\"w-full p-2 border border-gray-300 rounded-md h-32 focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\",placeholder:\"Share your knowledge...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{backgroundColor:brandColor},className:\"mt-4 text-white py-2 px-6 rounded-md hover:bg-[#5a0909]\",children:\"Post Answer\"})]})]})]});}function AskQuestionPage(_ref6){let{user,userData,onComplete}=_ref6;const[title,setTitle]=useState('');const[content,setContent]=useState('');const[loading,setLoading]=useState(false);const handleSubmit=async e=>{e.preventDefault();if(title.trim()===''||content.trim()===''||!user)return;setLoading(true);try{const questionRef=await addDoc(collection(db,'questions'),{title,content,authorId:user.uid,authorUsername:userData.username,createdAt:serverTimestamp(),answerCount:0});onComplete(questionRef.id);}catch(error){console.error(\"Error posting question:\",error);setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-6\",children:\"Ask a Public Question\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,onChange:e=>setTitle(e.target.value),placeholder:\"e.g., How do I potty train my 2-year-old?\",className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Content\"}),/*#__PURE__*/_jsx(\"textarea\",{value:content,onChange:e=>setContent(e.target.value),placeholder:\"Include all the information someone would need to answer your question.\",className:\"w-full p-2 border border-gray-300 rounded-md h-40 focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{backgroundColor:brandColor},className:\"text-white py-2 px-6 rounded-md hover:bg-[#5a0909] disabled:bg-gray-400\",children:loading?'Posting...':'Post Your Question'})]})]});}function ProfilePage(_ref7){let{user,userData,setUserData,onComplete}=_ref7;const[formData,setFormData]=useState(null);const[loading,setLoading]=useState(false);useEffect(()=>{if(userData){setFormData({role:userData.role||'',children:userData.children&&userData.children.length>0?userData.children:[{name:'',dob:'',gender:''}],dueDate:userData.dueDate||{month:'',year:''},referral:userData.referral||''});}},[userData]);if(!formData)return/*#__PURE__*/_jsx(LoadingScreen,{});const handleUpdate=async e=>{e.preventDefault();setLoading(true);const userDocRef=doc(db,'users',user.uid);const updatedData={...formData,children:formData.role==='parent'?formData.children.filter(c=>c.name||c.dob||c.gender):[],updatedAt:serverTimestamp()};try{await setDoc(userDocRef,updatedData,{merge:true});setUserData(prev=>({...prev,...updatedData}));alert(\"Profile updated successfully!\");onComplete();}catch(error){console.error(\"Error updating profile:\",error);alert(\"Failed to update profile.\");setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-4\",children:\"Edit Your Profile\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-6\",children:[\"Username: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"@\",userData.username]}),\" (cannot be changed)\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg mb-6\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-800\",children:\"We collect this info to improve your experience and share the latest offers. As a thank-you, we\\u2019ll send a special birthday gift and up to 20% off for your child \\u2014 stackable with any current deals. Your trust means a lot to us!\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-6\",children:\"A complete form to edit all your details would appear here, similar to the onboarding flow.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleUpdate,disabled:loading,style:{backgroundColor:brandColor},className:\"text-white py-2 px-6 rounded-md hover:bg-[#5a0909] disabled:bg-gray-400\",children:loading?'Saving...':'Save Changes'})]});}function LoadingScreen(_ref8){let{text=\"Loading...\"}=_ref8;return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-screen -mt-20\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-10 w-10 mx-auto\",style:{color:brandColor},xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-lg font-semibold text-gray-700\",children:text})]})});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","initializeApp","getAuth","onAuthStateChanged","signOut","firebaseSignOut","signInWithCustomToken","signInAnonymously","getFirestore","doc","getDoc","setDoc","collection","query","addDoc","updateDoc","deleteDoc","onSnapshot","serverTimestamp","jsx","_jsx","jsxs","_jsxs","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","auth","db","App","page","setPage","user","setUser","userData","setUserData","loading","setLoading","currentQuestionId","setCurrentQuestionId","unsubscribe","currentUser","userDocRef","uid","userDocSnap","exists","data","username","onboardingComplete","performSignIn","error","console","handleLogout","navigateTo","pageName","questionId","arguments","length","undefined","LoadingScreen","renderPage","WelcomePage","SetUsernamePage","onComplete","OnboardingPage","CommunityFeed","QuestionDetailPage","ProfilePage","AskQuestionPage","id","className","children","Header","onLogout","brandColor","_ref","style","color","onClick","backgroundColor","charAt","toUpperCase","href","e","preventDefault","viewBox","fill","d","_ref2","setUsername","isValid","setIsValid","isAvailable","setIsAvailable","setError","checkUsernameAvailability","debounce","func","delay","timeout","_len","args","Array","_key","clearTimeout","setTimeout","name","usernameDocRef","docSnap","handleUsernameChange","value","target","toLowerCase","regex","test","handleSubmit","email","createdAt","merge","err","onSubmit","type","onChange","placeholder","disabled","_ref3","step","setStep","role","setRole","setChildren","dob","gender","dueDate","setDueDate","month","year","referral","setReferral","handleRoleSelect","selectedRole","handleAddChild","handleChildChange","index","field","newChildren","handleRemoveChild","filter","_","i","alert","onboardingData","c","updatedAt","today","Date","toISOString","split","currentYear","getFullYear","currentMonth","getMonth","months","years","from","map","child","max","htmlFor","required","_ref4","questions","setQuestions","q","querySnapshot","questionsData","docs","sort","a","b","_b$createdAt","_a$createdAt","seconds","text","title","content","authorUsername","answerCount","_ref5","question","setQuestion","answers","setAnswers","newAnswer","setNewAnswer","questionRef","unsubscribeQuestion","answersQuery","unsubscribeAnswers","snapshot","answersData","_b$upvotes","_a$upvotes","upvotes","handleAnswerSubmit","trim","answerRef","authorId","handleVote","answerId","currentUpvotes","userId","newUpvotes","includes","push","answer","_answer$upvotes","_answer$upvotes2","_answer$upvotes3","_answer$upvotes4","xmlns","fillRule","clipRule","_ref6","setTitle","setContent","_ref7","formData","setFormData","handleUpdate","updatedData","prev","_ref8","cx","cy","r","stroke","strokeWidth"],"sources":["/Users/mayankratankaneshiya/Documents/redmonkys-circle/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport {\n    getAuth,\n    onAuthStateChanged,\n    signOut as firebaseSignOut,\n    signInWithCustomToken,\n    signInAnonymously\n} from 'firebase/auth';\nimport {\n    getFirestore,\n    doc,\n    getDoc,\n    setDoc,\n    collection,\n    query,\n    addDoc,\n    updateDoc,\n    deleteDoc,\n    onSnapshot,\n    serverTimestamp\n} from 'firebase/firestore';\n\n// --- Firebase Configuration ---\n// This is now your real project configuration.\nconst firebaseConfig = {\n  apiKey: \"AIzaSyD2Q_M1tUmEELmYZJekOJCCTYtwlM-_2DU\",\n  authDomain: \"redmonkys-circle-ultimate.firebaseapp.com\",\n  projectId: \"redmonkys-circle-ultimate\",\n  storageBucket: \"redmonkys-circle-ultimate.firebasestorage.app\",\n  messagingSenderId: \"337937977339\",\n  appId: \"1:337937977339:web:b76ae3d7da470558b0855e\",\n  measurementId: \"G-7P6JRHKNMK\"\n};\n\n\n// --- Initialize Firebase ---\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n\n// --- Main App Component ---\nexport default function App() {\n    const [page, setPage] = useState('home');\n    const [user, setUser] = useState(null);\n    const [userData, setUserData] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [currentQuestionId, setCurrentQuestionId] = useState(null);\n\n    useEffect(() => {\n        const unsubscribe = onAuthStateChanged(auth, async (currentUser) => {\n            if (currentUser) {\n                setUser(currentUser);\n                const userDocRef = doc(db, 'users', currentUser.uid);\n                const userDocSnap = await getDoc(userDocRef);\n                if (userDocSnap.exists()) {\n                    const data = userDocSnap.data();\n                    setUserData(data);\n                    if (!data.username) setPage('setUsername');\n                    else if (!data.onboardingComplete) setPage('onboarding');\n                    else if (page !== 'question') setPage('feed');\n                } else {\n                    setPage('setUsername');\n                }\n            } else {\n                setUser(null);\n                setUserData(null);\n                setPage('home');\n            }\n            setLoading(false);\n        });\n\n        const performSignIn = async () => {\n            if (!auth.currentUser) {\n                try {\n                   // For the proxy, we'll rely on anonymous sign-in initially.\n                   // A more advanced setup could pass a customer token from Shopify.\n                   await signInAnonymously(auth);\n                } catch (error) {\n                    console.error(\"Error during automatic sign-in:\", error);\n                    setLoading(false);\n                }\n            }\n        };\n\n        performSignIn();\n        return () => unsubscribe();\n    }, []);\n\n    const handleLogout = async () => {\n        try {\n            await firebaseSignOut(auth);\n            setPage('home');\n        } catch (error) {\n            console.error(\"Error signing out:\", error);\n        }\n    };\n\n    const navigateTo = (pageName, questionId = null) => {\n        setPage(pageName);\n        setCurrentQuestionId(questionId);\n    };\n\n    if (loading) return <LoadingScreen />;\n\n    const renderPage = () => {\n        switch (page) {\n            case 'home': return <WelcomePage />;\n            case 'setUsername': return <SetUsernamePage user={user} onComplete={() => navigateTo('onboarding')} />;\n            case 'onboarding': return <OnboardingPage user={user} onComplete={() => navigateTo('feed')} />;\n            case 'feed': return <CommunityFeed navigateTo={navigateTo} user={user} />;\n            case 'question': return <QuestionDetailPage questionId={currentQuestionId} user={user} userData={userData} navigateTo={navigateTo} />;\n            case 'profile': return <ProfilePage user={user} userData={userData} setUserData={setUserData} onComplete={() => navigateTo('feed')} />;\n            case 'ask': return <AskQuestionPage user={user} userData={userData} onComplete={(id) => navigateTo('question', id)} />;\n            default: return <WelcomePage />;\n        }\n    };\n\n    return (\n        <div className=\"bg-gray-50 min-h-screen font-sans\">\n            <Header user={user} userData={userData} onLogout={handleLogout} navigateTo={navigateTo} />\n            <main className=\"container mx-auto px-4 py-8\">\n                {renderPage()}\n            </main>\n        </div>\n    );\n}\n\n// --- Components ---\n\nconst brandColor = '#6d0b0b';\n\nfunction Header({ user, userData, onLogout, navigateTo }) {\n    return (\n        <header className=\"bg-white shadow-md sticky top-0 z-50\">\n            <nav className=\"container mx-auto px-4 py-3 flex justify-between items-center\">\n                <div className=\"text-2xl font-bold cursor-pointer\" style={{ color: brandColor }} onClick={() => navigateTo(user ? 'feed' : 'home')}>\n                    RedMonkys Circle\n                </div>\n                {user && userData?.username && (\n                    <div className=\"flex items-center space-x-4\">\n                        <button onClick={() => navigateTo('ask')} style={{ backgroundColor: brandColor }} className=\"text-white px-4 py-2 rounded-full hover:bg-[#5a0909] transition duration-300 font-semibold\">\n                            Ask Question\n                        </button>\n                        <div className=\"relative group\">\n                            <div className=\"w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center text-lg font-bold text-gray-600 cursor-pointer\">\n                                {userData.username.charAt(0).toUpperCase()}\n                            </div>\n                            <div className=\"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20 hidden group-hover:block\">\n                                <a href=\"#\" onClick={(e) => { e.preventDefault(); navigateTo('profile'); }} className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\">Profile</a>\n                                <a href=\"#\" onClick={(e) => { e.preventDefault(); onLogout(); }} className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\">Logout</a>\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </nav>\n        </header>\n    );\n}\n\nfunction WelcomePage() {\n    return (\n        <div className=\"text-center py-16 max-w-3xl mx-auto\">\n            <h1 className=\"text-4xl md:text-5xl font-extrabold text-gray-800 mb-6\">🤍 Welcome to RedMonkys Circle.</h1>\n            <p className=\"text-lg text-gray-600 mb-8 leading-relaxed\">\n                This space is made just for you — the loving, curious, sometimes-tired, always-caring parent. Whether you have questions, stories, doubts, or advice — you're not alone. Ask freely. Share generously. Support each other. At RedMonkys, we believe that every parent/guardian deserves to be heard, and every child deserves a world full of love, understanding, and growth. This is a judgment-free zone — a gentle corner of the internet where you’re seen, your concerns matter, and your voice helps others feel a little less alone.\n                <br/><br/>\n                <strong>Together, we’re building more than a brand. We’re building a community of care.</strong>\n            </p>\n            <button onClick={() => {}} className=\"bg-white border border-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-lg shadow-sm hover:shadow-md transition-all duration-300 flex items-center mx-auto\">\n                <svg className=\"w-6 h-6 mr-3\" viewBox=\"0 0 48 48\"><path fill=\"#4285F4\" d=\"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\"></path><path fill=\"#34A853\" d=\"M46.98 24.55c0-1.57-.15-3.09-.42-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\"></path><path fill=\"#FBBC05\" d=\"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\"></path><path fill=\"#EA4335\" d=\"M24 48c6.48 0 11.87-2.13 15.84-5.73l-7.73-6c-2.52 1.7-5.94 2.73-9.91 2.73-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\"></path><path fill=\"none\" d=\"M0 0h48v48H0z\"></path></svg>\n                Login with Google\n            </button>\n        </div>\n    );\n}\n\nfunction SetUsernamePage({ user, onComplete }) {\n    const [username, setUsername] = useState('');\n    const [isValid, setIsValid] = useState(false);\n    const [isAvailable, setIsAvailable] = useState(true);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState('');\n\n    const checkUsernameAvailability = useMemo(() => {\n        const debounce = (func, delay) => { let timeout; return (...args) => { clearTimeout(timeout); timeout = setTimeout(() => func(...args), delay); }; };\n        return debounce(async (name) => {\n            if (name.length > 2) {\n                setLoading(true);\n                const usernameDocRef = doc(db, 'usernames', name);\n                const docSnap = await getDoc(usernameDocRef);\n                setIsAvailable(!docSnap.exists()); setLoading(false);\n            }\n        }, 500);\n    }, []);\n\n    const handleUsernameChange = (e) => {\n        const value = e.target.value.toLowerCase();\n        const regex = /^[a-z0-9_]+$/;\n        setUsername(value);\n        if (regex.test(value) && value.length >= 3 && value.length <= 15) {\n            setIsValid(true); setError(''); checkUsernameAvailability(value);\n        } else {\n            setIsValid(false); setError('3-15 chars, lowercase, numbers, or _');\n        }\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        if (!isValid || !isAvailable || loading || !user) return;\n        setLoading(true); setError('');\n        try {\n            const userDocRef = doc(db, 'users', user.uid);\n            const usernameDocRef = doc(db, 'usernames', username);\n            await setDoc(userDocRef, { uid: user.uid, email: user.email || 'anonymous', username: username, createdAt: serverTimestamp() }, { merge: true });\n            await setDoc(usernameDocRef, { uid: user.uid });\n            onComplete();\n        } catch (err) {\n            console.error(err); setError('Could not save username. Please try again.'); setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"max-w-md mx-auto bg-white p-8 rounded-lg shadow-lg\">\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">Create your username</h2>\n            <p className=\"text-gray-600 mb-6\">This is permanent and will be shown with your questions and answers.</p>\n            <form onSubmit={handleSubmit}>\n                <div className=\"relative\">\n                    <span className=\"absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500\">@</span>\n                    <input type=\"text\" value={username} onChange={handleUsernameChange} className=\"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-md focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\" placeholder=\"your_unique_username\"/>\n                </div>\n                <div className=\"h-5 mt-1 text-sm\">\n                    {loading && <p className=\"text-gray-500\">Checking...</p>}\n                    {!loading && username && !isAvailable && <p className=\"text-red-500\">Username already taken.</p>}\n                    {!loading && username && isAvailable && isValid && <p className=\"text-green-500\">Username is available!</p>}\n                    {error && <p className=\"text-red-500\">{error}</p>}\n                </div>\n                <button type=\"submit\" disabled={!isValid || !isAvailable || loading} style={{ backgroundColor: brandColor }} className=\"w-full mt-4 text-white py-2 px-4 rounded-md hover:bg-[#5a0909] disabled:bg-gray-400 transition\">\n                    Confirm Username\n                </button>\n            </form>\n        </div>\n    );\n}\n\nfunction OnboardingPage({ user, onComplete }) {\n    const [step, setStep] = useState(1);\n    const [role, setRole] = useState('');\n    const [children, setChildren] = useState([{ name: '', dob: '', gender: '' }]);\n    const [dueDate, setDueDate] = useState({ month: '', year: '' });\n    const [referral, setReferral] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    const handleRoleSelect = (selectedRole) => { setRole(selectedRole); setStep(2); };\n    const handleAddChild = () => { setChildren([...children, { name: '', dob: '', gender: '' }]); };\n    const handleChildChange = (index, field, value) => { const newChildren = [...children]; newChildren[index][field] = value; setChildren(newChildren); };\n    const handleRemoveChild = (index) => { const newChildren = children.filter((_, i) => i !== index); setChildren(newChildren); };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        if(!referral) { alert(\"Please let us know how you heard about us.\"); return; }\n        setLoading(true);\n        const userDocRef = doc(db, 'users', user.uid);\n        const onboardingData = { role, children: role === 'parent' ? children.filter(c => c.name || c.dob || c.gender) : [], dueDate: role === 'expecting' ? dueDate : {}, referral, onboardingComplete: true, updatedAt: serverTimestamp() };\n        try { await setDoc(userDocRef, onboardingData, { merge: true }); onComplete(); } catch (error) { console.error(\"Error saving onboarding data:\", error); setLoading(false); }\n    };\n\n    const today = new Date().toISOString().split('T')[0];\n    const currentYear = new Date().getFullYear(); const currentMonth = new Date().getMonth() + 1;\n    const months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n    const years = Array.from({length: 10}, (_, i) => currentYear + i);\n\n    return (\n        <div className=\"max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-lg\">\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Tell us a bit about yourself</h2>\n            <p className=\"text-gray-600 mb-8\">This helps us personalize your experience.</p>\n            {step === 1 && (\n                <div className=\"space-y-4\">\n                    <h3 className=\"font-semibold text-lg\">First, what best describes you?</h3>\n                    <button onClick={() => handleRoleSelect('parent')} className=\"w-full text-left p-4 border rounded-lg hover:bg-red-50 hover:border-[#6d0b0b] transition\">I'm a parent / guardian</button>\n                    <button onClick={() => handleRoleSelect('expecting')} className=\"w-full text-left p-4 border rounded-lg hover:bg-red-50 hover:border-[#6d0b0b] transition\">I will be a parent soon</button>\n                    <button onClick={() => handleRoleSelect('not_parent')} className=\"w-full text-left p-4 border rounded-lg hover:bg-red-50 hover:border-[#6d0b0b] transition\">I'm not a parent</button>\n                </div>\n            )}\n            {step === 2 && (\n                <form onSubmit={handleSubmit}>\n                    {role === 'parent' && (\n                        <div className=\"mb-6\">\n                            <h3 className=\"font-semibold text-lg mb-4\">Tell us about your child/children.</h3>\n                            {children.map((child, index) => (\n                                <div key={index} className=\"grid grid-cols-1 md:grid-cols-3 gap-4 border p-4 rounded-lg mb-4 relative\">\n                                    {children.length > 1 && <button type=\"button\" onClick={() => handleRemoveChild(index)} className=\"absolute top-2 right-2 text-red-500 hover:text-red-700\">&times;</button>}\n                                    <div><label className=\"block text-sm font-medium text-gray-700\">Child's Name/Nickname</label><input type=\"text\" value={child.name} onChange={e => handleChildChange(index, 'name', e.target.value)} className=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"/></div>\n                                    <div><label className=\"block text-sm font-medium text-gray-700\">Child's Date of Birth</label><input type=\"date\" max={today} value={child.dob} onChange={e => handleChildChange(index, 'dob', e.target.value)} className=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"/></div>\n                                    <div><label className=\"block text-sm font-medium text-gray-700\">Child's Gender</label><select value={child.gender} onChange={e => handleChildChange(index, 'gender', e.target.value)} className=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"><option value=\"\">Select...</option><option value=\"male\">Male</option><option value=\"female\">Female</option><option value=\"prefer_not_to_say\">Prefer not to say</option></select></div>\n                                </div>\n                            ))}\n                            <button type=\"button\" onClick={handleAddChild} className=\"font-semibold\" style={{color: brandColor}}>+ Add another child</button>\n                        </div>\n                    )}\n                    {role === 'expecting' && (\n                        <div className=\"mb-6\">\n                            <h3 className=\"font-semibold text-lg mb-4\">Congratulations! When are you due?</h3>\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div><label className=\"block text-sm font-medium text-gray-700\">Month</label><select value={dueDate.month} onChange={e => setDueDate({...dueDate, month: e.target.value})} className=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"><option value=\"\">Select Month</option>{months.map((month, i) => (<option key={month} value={i+1} disabled={dueDate.year == currentYear && i+1 < currentMonth}>{month}</option>))}</select></div>\n                                <div><label className=\"block text-sm font-medium text-gray-700\">Year</label><select value={dueDate.year} onChange={e => setDueDate({...dueDate, year: e.target.value})} className=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"><option value=\"\">Select Year</option>{years.map(year => <option key={year} value={year}>{year}</option>)}</select></div>\n                            </div>\n                        </div>\n                    )}\n                    <div className=\"mb-6\"><label htmlFor=\"referral\" className=\"block text-lg font-semibold text-gray-700\">How did you hear about us? (Required)</label><select id=\"referral\" value={referral} onChange={e => setReferral(e.target.value)} required className=\"mt-2 block w-full border-gray-300 rounded-md shadow-sm focus:ring-[#6d0b0b] focus:border-[#6d0b0b] p-2\"><option value=\"\">Select an option...</option><option value=\"facebook\">Facebook</option><option value=\"instagram\">Instagram</option><option value=\"youtube\">YouTube</option><option value=\"google\">Google Search</option><option value=\"friend_family\">Referred by friend or family</option><option value=\"other\">Other</option></select></div>\n                    <div className=\"flex justify-end\"><button type=\"submit\" disabled={loading} style={{ backgroundColor: brandColor }} className=\"text-white py-2 px-6 rounded-md hover:bg-[#5a0909] disabled:bg-gray-400 transition\">{loading ? 'Saving...' : 'Finish & Enter Circle'}</button></div>\n                </form>\n            )}\n        </div>\n    );\n}\n\nfunction CommunityFeed({ navigateTo, user }) {\n    const [questions, setQuestions] = useState([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        if (!user) { setLoading(true); return; }\n        const q = query(collection(db, 'questions'));\n        const unsubscribe = onSnapshot(q, (querySnapshot) => {\n            const questionsData = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n            questionsData.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));\n            setQuestions(questionsData); setLoading(false);\n        }, (error) => { console.error(\"Firestore permission error in CommunityFeed:\", error); setLoading(false); });\n        return () => unsubscribe();\n    }, [user]);\n\n    if (loading) return <LoadingScreen text=\"Loading the Circle...\" />;\n\n    return (\n        <div>\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-6\">Community Circle</h1>\n            <div className=\"bg-white rounded-lg shadow\"><ul className=\"divide-y divide-gray-200\">\n                {questions.map(q => (\n                    <li key={q.id} className=\"p-6 hover:bg-gray-50 cursor-pointer\" onClick={() => navigateTo('question', q.id)}>\n                        <h2 className=\"font-semibold text-lg text-gray-800 hover:text-[#6d0b0b]\">{q.title}</h2>\n                        <p className=\"text-sm text-gray-600 mt-1 line-clamp-2\">{q.content}</p>\n                        <div className=\"flex items-center justify-between mt-3 text-xs text-gray-500\">\n                            <span>Asked by @{q.authorUsername}</span><span>{q.answerCount || 0} answers</span>\n                        </div>\n                    </li>\n                ))}\n            </ul></div>\n        </div>\n    );\n}\n\nfunction QuestionDetailPage({ questionId, user, userData, navigateTo }) {\n    const [question, setQuestion] = useState(null);\n    const [answers, setAnswers] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [newAnswer, setNewAnswer] = useState('');\n\n    useEffect(() => {\n        if (!user || !questionId) { setLoading(true); return; }\n        const questionRef = doc(db, 'questions', questionId);\n        const unsubscribeQuestion = onSnapshot(questionRef, (docSnap) => {\n            if (docSnap.exists()) setQuestion({ id: docSnap.id, ...docSnap.data() });\n            else console.error(\"Question not found\");\n            setLoading(false);\n        }, (error) => { console.error(\"Firestore permission error on question:\", error); setLoading(false); });\n        const answersQuery = query(collection(db, `questions/${questionId}/answers`));\n        const unsubscribeAnswers = onSnapshot(answersQuery, (snapshot) => {\n            const answersData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n            answersData.sort((a, b) => (b.upvotes?.length || 0) - (a.upvotes?.length || 0));\n            setAnswers(answersData);\n        }, (error) => { console.error(\"Firestore permission error on answers:\", error); });\n        return () => { unsubscribeQuestion(); unsubscribeAnswers(); };\n    }, [questionId, user]);\n\n    const handleAnswerSubmit = async (e) => {\n        e.preventDefault();\n        if (newAnswer.trim() === '' || !user) return;\n        const answerRef = collection(db, `questions/${questionId}/answers`);\n        await addDoc(answerRef, { content: newAnswer, authorId: user.uid, authorUsername: userData.username, createdAt: serverTimestamp(), upvotes: [] });\n        const questionRef = doc(db, 'questions', questionId);\n        await updateDoc(questionRef, { answerCount: answers.length + 1 });\n        setNewAnswer('');\n    };\n\n    const handleVote = async (answerId, currentUpvotes) => {\n        if (!user) return;\n        const answerRef = doc(db, `questions/${questionId}/answers`, answerId);\n        const userId = user.uid; let newUpvotes = [...(currentUpvotes || [])];\n        if (newUpvotes.includes(userId)) newUpvotes = newUpvotes.filter(uid => uid !== userId);\n        else newUpvotes.push(userId);\n        await updateDoc(answerRef, { upvotes: newUpvotes });\n    };\n\n    if (loading) return <LoadingScreen text=\"Loading question...\" />;\n    if (!question) return <div>Question not found. <button onClick={() => navigateTo('feed')}>Back to feed</button></div>;\n\n    return (\n        <div>\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">{question.title}</h1>\n            <div className=\"text-sm text-gray-500 mb-4\">Asked by @{question.authorUsername}</div>\n            <p className=\"text-gray-700 whitespace-pre-wrap mb-8\">{question.content}</p>\n            <div className=\"my-8\">\n                <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">{answers.length} Answers</h2>\n                <div className=\"space-y-6\">\n                    {answers.map((answer, index) => (\n                        <div key={answer.id} className={`bg-white p-6 rounded-lg shadow ${index === 0 && answer.upvotes?.length > 0 ? 'border-2 border-green-400' : ''}`}>\n                            {index === 0 && answer.upvotes?.length > 0 && <div className=\"text-sm font-bold text-green-600 mb-2\">BEST ANSWER</div>}\n                            <p className=\"text-gray-800 mb-4\">{answer.content}</p>\n                            <div className=\"flex justify-between items-center\">\n                                <div className=\"text-sm text-gray-500\">Answered by @{answer.authorUsername}</div>\n                                <div className=\"flex items-center space-x-2\">\n                                    <button onClick={() => handleVote(answer.id, answer.upvotes)} className=\"group\">\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className={`h-7 w-7 transition-all duration-200 ${answer.upvotes?.includes(user?.uid) ? 'text-red-500 scale-110' : 'text-gray-400 group-hover:text-red-300'}`} viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fillRule=\"evenodd\" d=\"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z\" clipRule=\"evenodd\" /></svg>\n                                    </button>\n                                    <span className=\"font-bold text-gray-700\">{answer.upvotes?.length || 0}</span>\n                                </div>\n                            </div>\n                        </div>\n                    ))}\n                </div>\n            </div>\n            <div className=\"mt-10 bg-white p-6 rounded-lg shadow\">\n                <h3 className=\"font-bold text-lg mb-4\">Your Answer</h3>\n                <form onSubmit={handleAnswerSubmit}>\n                    <textarea value={newAnswer} onChange={(e) => setNewAnswer(e.target.value)} className=\"w-full p-2 border border-gray-300 rounded-md h-32 focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\" placeholder=\"Share your knowledge...\"></textarea>\n                    <button type=\"submit\" style={{ backgroundColor: brandColor }} className=\"mt-4 text-white py-2 px-6 rounded-md hover:bg-[#5a0909]\">Post Answer</button>\n                </form>\n            </div>\n        </div>\n    );\n}\n\nfunction AskQuestionPage({ user, userData, onComplete }) {\n    const [title, setTitle] = useState('');\n    const [content, setContent] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        if (title.trim() === '' || content.trim() === '' || !user) return;\n        setLoading(true);\n        try {\n            const questionRef = await addDoc(collection(db, 'questions'), { title, content, authorId: user.uid, authorUsername: userData.username, createdAt: serverTimestamp(), answerCount: 0 });\n            onComplete(questionRef.id);\n        } catch (error) { console.error(\"Error posting question:\", error); setLoading(false); }\n    };\n\n    return (\n        <div className=\"max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-lg\">\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-6\">Ask a Public Question</h2>\n            <form onSubmit={handleSubmit}>\n                <div className=\"mb-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Title</label>\n                    <input type=\"text\" value={title} onChange={e => setTitle(e.target.value)} placeholder=\"e.g., How do I potty train my 2-year-old?\" className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"/>\n                </div>\n                <div className=\"mb-6\">\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Content</label>\n                    <textarea value={content} onChange={e => setContent(e.target.value)} placeholder=\"Include all the information someone would need to answer your question.\" className=\"w-full p-2 border border-gray-300 rounded-md h-40 focus:ring-[#6d0b0b] focus:border-[#6d0b0b]\"></textarea>\n                </div>\n                <button type=\"submit\" disabled={loading} style={{ backgroundColor: brandColor }} className=\"text-white py-2 px-6 rounded-md hover:bg-[#5a0909] disabled:bg-gray-400\">\n                    {loading ? 'Posting...' : 'Post Your Question'}\n                </button>\n            </form>\n        </div>\n    );\n}\n\nfunction ProfilePage({ user, userData, setUserData, onComplete }) {\n    const [formData, setFormData] = useState(null);\n    const [loading, setLoading] = useState(false);\n\n    useEffect(() => {\n        if (userData) {\n            setFormData({ role: userData.role || '', children: userData.children && userData.children.length > 0 ? userData.children : [{ name: '', dob: '', gender: '' }], dueDate: userData.dueDate || { month: '', year: '' }, referral: userData.referral || '' });\n        }\n    }, [userData]);\n\n    if (!formData) return <LoadingScreen />;\n\n    const handleUpdate = async (e) => {\n        e.preventDefault(); setLoading(true);\n        const userDocRef = doc(db, 'users', user.uid);\n        const updatedData = { ...formData, children: formData.role === 'parent' ? formData.children.filter(c => c.name || c.dob || c.gender) : [], updatedAt: serverTimestamp() };\n        try {\n            await setDoc(userDocRef, updatedData, { merge: true });\n            setUserData(prev => ({...prev, ...updatedData}));\n            alert(\"Profile updated successfully!\"); onComplete();\n        } catch (error) { console.error(\"Error updating profile:\", error); alert(\"Failed to update profile.\"); setLoading(false); }\n    };\n\n    return (\n        <div className=\"max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-lg\">\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Edit Your Profile</h2>\n            <p className=\"text-gray-600 mb-6\">Username: <span className=\"font-semibold\">@{userData.username}</span> (cannot be changed)</p>\n            <div className=\"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg mb-6\">\n                <p className=\"text-blue-800\">We collect this info to improve your experience and share the latest offers. As a thank-you, we’ll send a special birthday gift and up to 20% off for your child — stackable with any current deals. Your trust means a lot to us!</p>\n            </div>\n            <p className=\"text-sm text-gray-500 mb-6\">A complete form to edit all your details would appear here, similar to the onboarding flow.</p>\n            <button onClick={handleUpdate} disabled={loading} style={{ backgroundColor: brandColor }} className=\"text-white py-2 px-6 rounded-md hover:bg-[#5a0909] disabled:bg-gray-400\">\n                {loading ? 'Saving...' : 'Save Changes'}\n            </button>\n        </div>\n    );\n}\n\nfunction LoadingScreen({ text = \"Loading...\" }) {\n    return (\n        <div className=\"flex items-center justify-center h-screen -mt-20\">\n            <div className=\"text-center\">\n                <svg className=\"animate-spin h-10 w-10 mx-auto\" style={{color: brandColor}} xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                </svg>\n                <p className=\"mt-4 text-lg font-semibold text-gray-700\">{text}</p>\n            </div>\n        </div>\n    );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}